services:
  server:
    build:
      context: server
      dockerfile: Dockerfile.server
      args:
        DB_HOST: ${DB_HOST}
        DB_NAME: ${DB_NAME}
        DB_PASSWORD: ${DB_PASSWORD}
        DB_PORT: ${DB_PORT}
        DB_USERNAME: ${DB_USERNAME}
    env_file:
      - .env
    ports:
      - "8080:8080"

  client:
    build:
      context: client
      dockerfile: Dockerfile.client
      args:
        VITE_API_URL: ${VITE_API_URL}
        VITE_SOURCE_URL: ${VITE_SOURCE_URL}
        VITE_GITHUB_URL: ${VITE_GITHUB_URL}
        VITE_TELEGRAM_URL: ${VITE_TELEGRAM_URL}
        VITE_LICENSE_URL: ${VITE_LICENSE_URL}
    env_file:
      - .env
    ports:
      - "5173:80"

  nginx:
    build:
      context: nginx
      dockerfile: Dockerfile.nginx
      args:
        ADMIN_USERNAME: ${ADMIN_USERNAME}
        ADMIN_PASSWORD: ${ADMIN_PASSWORD}
    env_file:
      - .env
    ports:
      - "80:80"
    depends_on:
      - client
      - server
